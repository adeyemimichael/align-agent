{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayobami/align/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport pg from 'pg'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nfunction createPrismaClient() {\n  const connectionString = process.env.DATABASE_URL\n  if (!connectionString) {\n    throw new Error('DATABASE_URL environment variable is not set')\n  }\n\n  const pool = new pg.Pool({ connectionString })\n  const adapter = new PrismaPg(pool)\n  \n  return new PrismaClient({ adapter })\n}\n\nexport const prisma = globalForPrisma.prisma ?? createPrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,kBAAkB;AAIxB,SAAS;IACP,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;IACjD,IAAI,CAAC,kBAAkB;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,OAAO,IAAI,iKAAE,CAAC,IAAI,CAAC;QAAE;IAAiB;IAC5C,MAAM,UAAU,IAAI,kLAAQ,CAAC;IAE7B,OAAO,IAAI,+MAAY,CAAC;QAAE;IAAQ;AACpC;AAEO,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayobami/align/lib/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport Google from \"next-auth/providers/google\";\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\nimport { prisma } from \"./prisma\";\n\nexport const { handlers, signIn, signOut, auth } = NextAuth({\n  adapter: PrismaAdapter(prisma),\n  providers: [\n    Google({\n      clientId: process.env.GOOGLE_CLIENT_ID!,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,\n      authorization: {\n        params: {\n          prompt: \"consent\",\n          access_type: \"offline\",\n          response_type: \"code\",\n        },\n      },\n    }),\n  ],\n  session: {\n    strategy: \"database\",\n  },\n  pages: {\n    signIn: \"/login\",\n    error: \"/login\", // Redirect errors to login page\n  },\n  callbacks: {\n    async session({ session, user }) {\n      if (session.user) {\n        session.user.id = user.id;\n      }\n      return session;\n    },\n  },\n  debug: process.env.NODE_ENV === \"development\", // Enable debug logs in development\n});\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;;;;;AAEO,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,2KAAQ,EAAC;IAC1D,SAAS,IAAA,gLAAa,EAAC,kIAAM;IAC7B,WAAW;QACT,IAAA,2KAAM,EAAC;YACL,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;YAC9C,eAAe;gBACb,QAAQ;oBACN,QAAQ;oBACR,aAAa;oBACb,eAAe;gBACjB;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,WAAW;QACT,MAAM,SAAQ,EAAE,OAAO,EAAE,IAAI,EAAE;YAC7B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,KAAK,EAAE;YAC3B;YACA,OAAO;QACT;IACF;IACA,OAAO,oDAAyB;AAClC"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayobami/align/app/api/checkin/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { auth } from '@/lib/auth';\nimport { prisma } from '@/lib/prisma';\nimport { z } from 'zod';\n\n// Validation schema for check-in data\nconst checkInSchema = z.object({\n  energy: z.number().int().min(1).max(10),\n  sleep: z.number().int().min(1).max(10),\n  stress: z.number().int().min(1).max(10),\n  mood: z.enum(['positive', 'neutral', 'negative']),\n});\n\n// Capacity score calculation function\nfunction calculateCapacityScore(\n  energy: number,\n  sleep: number,\n  stress: number,\n  mood: string\n): number {\n  // Weights based on design document\n  const energyWeight = 0.3;\n  const sleepWeight = 0.3;\n  const stressWeight = 0.25;\n  const moodWeight = 0.15;\n\n  // Normalize inputs to 0-1 scale\n  const normalizedEnergy = (energy - 1) / 9;\n  const normalizedSleep = (sleep - 1) / 9;\n  const normalizedStress = (stress - 1) / 9;\n\n  // Mood modifier\n  let moodModifier = 0.5; // neutral\n  if (mood === 'positive') moodModifier = 1.0;\n  if (mood === 'negative') moodModifier = 0.0;\n\n  // Calculate weighted score (stress is inverted - higher stress = lower score)\n  const score =\n    normalizedEnergy * energyWeight +\n    normalizedSleep * sleepWeight +\n    (1 - normalizedStress) * stressWeight +\n    moodModifier * moodWeight;\n\n  // Scale to 0-100\n  return Math.round(score * 100);\n}\n\n// Mode selection function\nfunction selectMode(capacityScore: number): string {\n  if (capacityScore < 40) return 'recovery';\n  if (capacityScore >= 70) return 'deep_work';\n  return 'balanced';\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const session = await auth();\n\n    if (!session || !session.user?.email) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\n    }\n\n    const body = await request.json();\n\n    // Validate input\n    const validationResult = checkInSchema.safeParse(body);\n    if (!validationResult.success) {\n      return NextResponse.json(\n        { error: 'Invalid input', details: validationResult.error.issues },\n        { status: 400 }\n      );\n    }\n\n    const { energy, sleep, stress, mood } = validationResult.data;\n\n    // Calculate capacity score and mode\n    const capacityScore = calculateCapacityScore(energy, sleep, stress, mood);\n    const mode = selectMode(capacityScore);\n\n    // Get user from database\n    const user = await prisma.user.findUnique({\n      where: { email: session.user.email },\n    });\n\n    if (!user) {\n      return NextResponse.json({ error: 'User not found' }, { status: 404 });\n    }\n\n    // Get today's date at midnight (UTC)\n    const today = new Date();\n    today.setUTCHours(0, 0, 0, 0);\n\n    // Upsert check-in (create or update if exists for today)\n    const checkIn = await prisma.checkIn.upsert({\n      where: {\n        userId_date: {\n          userId: user.id,\n          date: today,\n        },\n      },\n      update: {\n        energy,\n        sleep,\n        stress,\n        mood,\n        capacityScore,\n        mode,\n      },\n      create: {\n        userId: user.id,\n        date: today,\n        energy,\n        sleep,\n        stress,\n        mood,\n        capacityScore,\n        mode,\n      },\n    });\n\n    return NextResponse.json(checkIn, { status: 200 });\n  } catch (error) {\n    console.error('Check-in error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}